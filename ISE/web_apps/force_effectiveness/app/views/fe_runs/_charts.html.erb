<!-- needs MASSIVE cleanup -->

{
	"series":
		[
			<%  da_ticks = ""
				track_type_ticks = ""
				min_x_axis = 100000
				max_x_axis = 0
				@da_ids.each do |da_id|
					
					x_axis = (da_id.to_i-1)*10+5
					
					da_ticks = da_ticks + '[' + x_axis.to_s + ', "' + @DefendedAreaNames[da_id.to_i].to_s + '"],'
					da_ticks = da_ticks + '[' + x_axis.to_s + ', "' + @DefendedAreaNames[da_id.to_i].to_s + '"],'


					i = 0
					@track_types.each do |track_type|
						x_axis = (da_id.to_i-1)*10 + i*5
						track_type_ticks = track_type_ticks + '[' + x_axis.to_s + ', "' + track_type + '"],'
						i = i + 1 
					end

					x_axis = (da_id.to_i-1)*10 + i*5
					track_type_ticks = track_type_ticks + '[' + x_axis.to_s + ', " "],'
					track_type_ticks = track_type_ticks + '[' + (x_axis - 0.5).to_s + ', " "],'

					if x_axis > max_x_axis
						max_x_axis = x_axis + 10
					end
				
					if x_axis < min_x_axis
						min_x_axis = x_axis - 1
					end
				end	%>

			<% result_counter = 0 %>
			<% axis_switch = 1%>
			
  			<% @result_da_category_hash.each_pair do |result, da_category_hash| %>
				
				{ "data": [
				<% da_category_hash.each_pair do |da_id, category_array| %>
					<% category_counter = 0 %>
					<% category_array.each do |event_count| %>
					
						[<%= ((da_id.to_i - 1)*10 + (category_counter * 5) + result_counter).to_s %>, <%= event_count == 0 ? '0.1' : h(event_count) %>],
						<% category_counter = category_counter + 1 %>
						
					<% end %>
					
				<% end %>
				], "label": "<%= result %>", "xaxis": <%= axis_switch %>},
				
				<% result_counter = result_counter + 1 %>
				<% axis_switch == 1 ? axis_switch = 2 : axis_switch = 1%>
				
			<% end %>
		], 
	"options": 
		{ 
			"title": "Engagement Results by DA & Track Type",
			"bars": {"show": true, "barWidth": 1, "centered": true},
			"yaxis": {"noTicks": 5, "showLabels": true, "autoScaleMargin": 0, "min": 0, "max": 6},
			"xaxis": {"show": true, "noTicks": 5, "min": <%= min_x_axis %>, "max": <%= max_x_axis %>, "ticks": [<%= track_type_ticks %>]},
			"x2axis": {"show": true, "noTicks": 5, "min": <%= min_x_axis %>, "max": <%= max_x_axis %>, "ticks":[<%= da_ticks %>]}
			
		}    
}